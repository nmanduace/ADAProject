---
title: "Data Analysis"
author: "Nnenna Anako, Joanne Song, Nicandro Mandujano Acevedo"
date: "4/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r}
DHSdata <- read.csv("NewADAProject.csv")
```

### Renaming Variables
```{r}
# Rename variables of who perpetuates violence
DHSdataC<-rename(DHSdata, Age=v012, Age_Cat=v013, WealthIndex=v190, WealthScore=v191, 
                 UnionStatus=v502, EmoVio=d104, LessPA=d106, 
                 SeverPA=d107, SexVio=d108, HouseholdLiving=hv012, SonsLivingH=v202, 
                 DaughtersLivingH=v203,Working=v714, TypeRes=v140, PartDrink=d113)
```

### Recode a variable for total children living at home
```{r}
DHSdataC<-dplyr::mutate(DHSdataC, ChildHouseLive = SonsLivingH + DaughtersLivingH)
```

### Creating a new Variable for those that have experienced any form of violenve
```{r}
#Firdst need to make this a factor
DHSdataC$EmoVio <- as.factor(DHSdataC$EmoVio)
DHSdataC$LessPA <- as.factor(DHSdataC$LessPA)
DHSdataC$SeverPA <- as.factor(DHSdataC$SeverPA)
DHSdataC$SexVio <- as.factor(DHSdataC$SexVio)

# Make all 9 be NAs
DHSdataC$EmoVio<-dplyr::na_if(DHSdataC$EmoVio, 9)
DHSdataC$LessPA<-dplyr::na_if(DHSdataC$LessPA, 9)
DHSdataC$SexVio<-dplyr::na_if(DHSdataC$SexVio, 9)
DHSdataC$SeverPA<-dplyr::na_if(DHSdataC$SeverPA, 9)

# Make varible for if any type of violence
DHSdataC$AnyVio <- ifelse(DHSdataC$EmoVio==1|DHSdataC$LessPA==1|DHSdataC$SeverPA==1|
                            DHSdataC$SexVio==1,1,0)

# Change yo factor
DHSdataC$AnyVio<-as.factor(DHSdataC$AnyVio)

#Plotting to make sure it worked
DHSdataC %>% 
  filter(!is.na(AnyVio)) %>% 
ggplot(aes(x=AnyVio))+
  geom_bar(na.rm = T)
```

# RUNNING LOGISTIC REGRESSIONS
Four models to be run:
1- Children living in household plus controls
2- Work plus control
3- Partner drinks plus control
4- All independent variables controls

### Model 1 - Children living in the household as IV

1. Examining the distribution of children living in the household by ever expereinced violence
```{r}
#Make labels for ever expereinced violence
DHSdataC$AnyVio<- factor(DHSdataC$AnyVio, labels = c("Never Experienced", "Experienced Any"))

#Make box-plot 
DHSdataC %>%
  drop_na(c(AnyVio, ChildHouseLive)) %>%
  ggplot(aes(x = AnyVio, y = ChildHouseLive)) +
  geom_boxplot(aes(fill = AnyVio)) +
  labs(x = "Any Violence", y = "Children Living in Household") +
  theme_bw()
```

2. Determining if running age and number children living in the household can be run as continuous variables

```{r}
#linearity for age
age.times.logage <- DHSdataC$Age * log(DHSdataC$Age)#create term to test linearity

boxTidwellAge <- glm(AnyVio ~ Age + age.times.logage, data=DHSdataC, family="binomial") #Box Tidwell technique, test the assumption of linearity

summary(boxTidwellAge)

#linearity for children
child.times.logchild <- DHSdataC$ChildHouseLive * log(DHSdataC$ChildHouseLive)#create term to test linearity

boxTidwellChild <- glm(AnyVio ~ ChildHouseLive + child.times.logchild, data=DHSdataC, family="binomial") #Box Tidwell technique, test the assumption of linearity

summary(boxTidwellChild)
```

__Based on the box Tidwell results, neither the age or children living at home variables should be run a continuous. Therefore categorical variables need to be created for children living at home__

```{r}
#Creating a categorical variable for children living at home

```